import { NotificationVO } from '../models/NotificationVO';

/**
 * é€šçŸ¥é¡µé¢
 */
@Component
export struct NotificationsPage {
  @State notifications: NotificationVO[] = [];

  aboutToAppear() {
    this.loadNotifications();
  }

  /**
   * åŠ è½½é€šçŸ¥åˆ—è¡¨ï¼ˆæ¨¡æ‹Ÿæ•°æ®ï¼‰
   */
  loadNotifications() {
    // æ¨¡æ‹Ÿæ•°æ®ï¼Œå®žé™…åº”è¯¥ä»ŽåŽç«¯èŽ·å–
    this.notifications = [];
    // æš‚æ—¶ä¸ºç©ºï¼Œæ˜¾ç¤ºç©ºçŠ¶æ€
  }

  build() {
    Column() {
      // æ ‡é¢˜æ 
      Row() {
        Text('é€šçŸ¥')
          .fontSize(20)
          .fontWeight(FontWeight.Bold)
          .layoutWeight(1)
          .textAlign(TextAlign.Center);
      }
      .width('100%')
      .height(56)
      .padding({ left: 16, right: 16 })
      .backgroundColor('#FFFFFF')
      .alignItems(VerticalAlign.Center);

      // å†…å®¹åŒºåŸŸ
      if (this.notifications.length === 0) {
        // ç©ºçŠ¶æ€
        Column() {
          Text('ðŸ‘»')
            .fontSize(60)
            .margin({ bottom: 16 });
          
          Text('æš‚æœªæ”¶åˆ°é€šçŸ¥')
            .fontSize(16)
            .fontColor('#999999');
        }
        .width('100%')
        .layoutWeight(1)
        .justifyContent(FlexAlign.Center)
        .alignItems(HorizontalAlign.Center);
      } else {
        List() {
          ForEach(this.notifications, (notification: NotificationVO) => {
            ListItem() {
              Row() {
                Column() {
                  Text(notification.title)
                    .fontSize(16)
                    .fontWeight(FontWeight.Medium)
                    .fontColor('#333333');
                  
                  Text(notification.content)
                    .fontSize(14)
                    .fontColor('#666666')
                    .maxLines(2)
                    .textOverflow({ overflow: TextOverflow.Ellipsis })
                    .margin({ top: 4 });
                  
                  Text(notification.createTime)
                    .fontSize(12)
                    .fontColor('#999999')
                    .margin({ top: 4 });
                }
                .layoutWeight(1)
                .alignItems(HorizontalAlign.Start);

                if (!notification.isRead) {
                  Blank()
                    .width(8)
                    .height(8)
                    .backgroundColor('#FF3B30')
                    .borderRadius(4);
                }
              }
              .width('100%')
              .padding({ left: 16, right: 16, top: 12, bottom: 12 })
              .backgroundColor('#FFFFFF')
              .onClick(() => {
                // æ ‡è®°ä¸ºå·²è¯»
                notification.isRead = true;
              });
            }
          }, (notification: NotificationVO) => notification.id.toString());
        }
        .layoutWeight(1)
        .backgroundColor('#F5F5F5');
      }
    }
    .width('100%')
    .height('100%')
    .backgroundColor('#F5F5F5');
  }
}

